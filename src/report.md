# DO1_Linux

## Part 1. Установка ОС
- ![image.png](./images/part1.png)<br>
  Получили версию Ubuntu, выполнив команду `cat /etc/issue`.

## Part 2. Создание пользователя
- ![image.png](./images/part2_1.png)<br>
  Создали нового пользователя командой `sudo adduser spaghetc2`.

- ![image.png](./images/part2_2.png)<br>
  Добавили пользователя в группу `adm` командой `sudo usermod -aG adm spaghetc2`.

- ![image.png](./images/part2_3.png)<br>
  Убедились, что пользователь принадлежит к группе `adm` командой `groups spaghetc2`.

- ![image.png](./images/part2_4.png)<br>
  Новый пользователь есть в выводе команды `cat /etc/passwd`.

## Part 3. Настройка сети ОС

- ![image.png](./images/part3_1.png)<br>
  Задали название машины вида `user-1` командой `sudo hostnamectl set-hostname user-1`.

- ![image.png](./images/part3_2.png)<br>
  Вывели название машины командой `hostname`.

- ![image.png](./images/part3_3.png)<br>
  Установили временную зону в соответствии с местоположением командой `timedatectl set-timezone Europe/Moscow`.

- ![image.png](./images/part3_4.png)<br>
  Проверили, что временная зона установилась командой `timedatectl`.

- ![image.png](./images/part3_5.png)<br>
  Получили информацию о сетевых интерфейсах командой `ip a`.

- Интерфейс `lo` является виртуальным сетевым интерфейсом, используемым для связи приложений и процессов. Имеет фиксированный IP-адрес `127.0.0.1` и маску подсети `255.0.0.0`.

- ![image.png](./images/part3_6.png)<br>
  Получили информацию об IP-адресе устройства от DHCP-сервера командой `sudo dhclient -v`.

- DHCP (Dynamic Host Configuration Protocol) — это сетевой протокол, который автоматизирует процесс назначения IP-адресов и других сетевых параметров устройствам в сети.

- ![image.png](./images/part3_7.png)<br>
  Получили внешний IP-адрес шлюза (ip) командой `curl 2ip.ru`. 

- ![image.png](./images/part3_8.png)<br>
  Получили внутренний IP-адрес шлюза (gw) командой `ip route`.

- ![image.png](./images/part3_9.png)<br>
  Открываем файл конфигурации `Netplan` командой `sudo nano /etc/netplan/00-installer-config.yaml`.

- ![image.png](./images/part3_10.png)<br>
  Задали статичные настройки ip, gw, dns.
  1. Установили `dhcp4` в `false`, чтобы отключить динамическое назначение IP-адресов.
  2. Указали статический IP-адрес сервера `10.0.2.119/24`.
  3. Указали внутренний IP-адрес шлюза `10.0.2.2`.
  4. Указали `dns` Google `8.8.8.8`.
  5. Указали публичный DNS-резолвер `1.1.1.1`.

- ![image.png](./images/part3_11.png)<br>
  Применяем настройки командой `sudo netplan apply`.

- ![image.png](./images/part3_12.png)<br>
  Перезапускаем виртуальную машину командой `reboot`.

- ![image.png](./images/part3_13.png)<br>
  Получаем внутренний IP-адрес шлюза (gw) командой `ip route`.

- ![image.png](./images/part3_14.png)<br>
  Проводим успешный пинг хостов `1.1.1.1` и `ya.ru(77.88.44.242)` командой `ping`.

## Part 4. Обновление ОС

- ![image.png](./images/part4_1.png)<br>
  Проверим актуальность текущих системных пакетов командой `sudo apt update`.

- ![image.png](./images/part4_2.png)<br>
  Проводим обновление системных пакетов командой `sudo apt full-upgrate`.

## Part 5. Использование команды sudo

- `sudo` (расшифровывается как `superuser do`) - используется для выполнения пользователем какой-либо команды, требующей права суперпользователя(root).

- ![image.png](./images/part5_1.png)<br>
  Дали право пользователю `spaghetc2` использовать команду `sudo`, прописав команду `sudo usermod -aG sudo spaghetc2`.

- ![image.png](./images/part5_2.png)<br>
  Сменили пользователя на `spaghetc2` командой `su spaghetc2`.

- ![image.png](./images/part5_3.png)<br>
  Сменили название машины на `user-2` от имени `spaghetc2` командой `sudo hostname user-2` и убедились, что название изменилось командой `hostname`.

## Part 6. Установка и настройка службы времени

- ![image.png](./images/part6_1.png)<br>
  Включаем синхронизацию NTP командой `sudo timedatectl set-ntp on`.

- ![image.png](./images/part6_2.png)<br>
  Убедились, что время синхронизируется автоматически командой `timedatectl show`.

## Part 7. Установка и использование текстовых редакторов

### VIM
- ![image.png](./images/part7_vim1.png)<br>
  Создаем файл `text_vim.txt` и открываем его через vim командой `sudo vim text_vim.txt`.

- ![image.png](./images/part7_vim2.png)<br>
  Для редактирования файла используем `i`, добавляем строку в файл, нажимаем `ESC` и сохраняем изменения прописывая `:wq`.

- ![image.png](./images/part7_vim3.png)<br>
  Открывает файл командой `sudo vim text_vim.txt`, заменяем строку на 21 School 21 и выходим без сохранения, прописывая `:q!`.

- ![image.png](./images/part7_vim4.png)<br>
  Убеждаемся в том, что файл не изменился командой `cat text_vim.txt`.

- ![image.png](./images/part7_vim5.png)<br>
  Выполняем поиск по слову через `/слово`, прописывая `/School`.

- ![image.png](./images/part7_vim6.png)<br>
  Выполняем замену по слова на другое через `:s/слово/новое слово`, прописывая `:s/School/21`.

- ![image.png](./images/part7_vim7.png)<br>
  Получаем результирующий файл.

### NANO
- ![image.png](./images/part7_nano1.png)<br>
  Создаем файл `text_nano.txt` и открываем его через nano командой `sudo nano text_vim.txt`.

- ![image.png](./images/part7_nano2.png)<br>
  Пишем строку, нажимаем `ctrl + o`, затем `ctrl + x`, выходя без сохранения.

- ![image.png](./images/part7_nano3.png)<br>
  Открывает файл командой `sudo nano text_vim.txt`, заменяем строку на 21 School 21 и выходим без сохранения, нажимая `ctrl + x` и не соглашаясь сохранить изменения.

- ![image.png](./images/part7_nano4.png)<br>
  Убеждаемся в том, что файл не изменился командой `cat text_nano.txt`.

- ![image.png](./images/part7_nano5.png)<br>
  Выполняем поиск по слову через `ctrl + w`, прописывая `School`.

- ![image.png](./images/part7_nano6.png)<br>
  Выполняем замену слова на другое через `ctrl + \`, заменяя `School` на `21`.

- ![image.png](./images/part7_nano7.png)<br>
  Получаем результирующий файл.

### MCEDIT
- ![image.png](./images/part7_mcedit1.png)<br>
  Устанавливаем редактор `mcedit` с пакетом `mc`.

- ![image.png](./images/part7_mcedit2.png)<br>
  Создаем файл `text_mcedit.txt` и открываем его через `mcedit` командой `sudo mcedit text_mcedit.txt`.

- ![image.png](./images/part7_mcedit3.png)<br>
  Отредактировав документ, нажимаем F10 и отвечаем Yes для выхода с сохранением.

- ![image.png](./images/part7_mcedit4.png)<br>
  Открывает файл командой `sudo mcedit text_mcedit.txt`, заменяем строку на 21 School 21 нажимаем F10 и выходим без сохранения, отвечая NO.

- ![image.png](./images/part7_mcedit5.png)<br>
  Убеждаемся в том, что файл не изменился командой `cat text_mcedit.txt`.

- ![image.png](./images/part7_mcedit6.png)<br>
  Выполняем поиск по слову `School` через F7.

- ![image.png](./images/part7_mcedit7.png)<br>
  Выполняем замену по слова на другое через F4.

- ![image.png](./images/part7_mcedit8.png)<br>
  Получаем результирующий файл.

## Part 8. Установка и базовая настройка сервиса SSHD

- ![image.png](./images/part8_1.png)<br>
  Устанавливаем `openssh-server` командой `sudo apt install openssh-server`.

- ![image.png](./images/part8_2.png)<br>
  Добавляем автостарт службы при загрузке системы командой `systemctl enable ssh`

- ![image.png](./images/part8_3.png)<br>
  Запускаем службу командой `systemctl start ssh` и проверяем статус командой `systemctl status ssh`.

- ![image.png](./images/part8_4.png)<br>
  Открываем файл командой `sudo nano /etc/ssh/sshd_config` и перенастраиваем службу SSHd на порт 2022.

- ![image.png](./images/part8_5.png)<br>
  Запускаем службу командой `systemctl start ssh` и проверяем статус командой `systemctl status ssh`.
  

- ![image.png](./images/part8_6.png)<br>
  Используя команду `ps`(команда для отображения отчета о работающих процессах) с флагами `-e` - расширяет вывод и `-f` - показывает полный формат списка процессов (UID пользователя, PID процесса, PPID родительского процесса, время запуска и команду, которая была использована для запуска процесса).

- Выполним перезагрузку системы командой `sudo reboot`.

- ![image.png](./images/part8_7.png)<br>

- Флаги `-tan` используются соответственно для того, чтобы показать порты tcp, список всех портов, показывать в численном виде ip адреса.

- Значения столбцов
  - Proto - наименование протокола.
  - Recv-Q - количество запросов в очередях на прием на локальном компьютере.
  - Send-Q - количество запросов в очередях на отправку на локальном компьютере.
  - Local Address - IP-адрес и порт локального компьютера.
  - Foreign Address - IP-адрес и порт компьютера, к которому подключен локальный компьютер.
  - State - статус соединения по протоколу TCP.
  - 0.0.0.0 - зарезервированный IP-адрес, обозначающий все возможные IP-адреса, означает, что сервер прослушивает все доступные сетевые интерфейсы на данном порту.

## Part 9. Установка и использование утилит top, htop

### Утилита top
- Запустим, используя команду `top`.

- ![image.png](./images/part9_1.png)<br>

- uptime: 2:50 h.
- количество авторизованных пользователей: 1.
- средняя загрузка системы: 0.05, 0.01, 0.00.
- общее количество процессов: 100.
- загрузка Cpu: 0.0 us, 7.1 sy, 0.0 ni, 92.9 id, 0.0 wa, 0.0 hi, 0.0 si, 0.0 st.
- загрузка памяти MiB Mem: 2974.6 total, 2373.0 free, 156.0 used, 445.5 buff/cache.
- pid процесса занимающего больше всего памяти: %MEM PID 1.
- pid процесса, занимающего больше всего процессорного времени: PID 2917.

### Утилита htop

- Запустим, используя команду `htop`.
- Используем для сортировки F6.

- ![image.png](./images/part9_2.png)<br>
Сортировка по PID.


- ![image.png](./images/part9_3.png)<br>
Сортировка по PERCENT_CPU.


- ![image.png](./images/part9_4.png)<br>
Сортировка по PERCENT_MEM.


- ![image.png](./images/part9_5.png)<br>
Сортировка по TIME.


- ![image.png](./images/part9_6.png)<br>
Отфильтруем для процесса sshd, нажав F4 и написав Filter: sshd.


- ![image.png](./images/part9_7.png)<br>
Поиск syslog через F3, прописав Search: syslog.


- ![image.png](./images/part9_8.png)<br>
Добавление вывода hostname, clock и uptime F2 + необходимые параметры + ESC.

## Part 10. Использование утилиты fdisks

- Используем команду `sudo fdisk -l`.

- ![image.png](./images/part10_1.png)<br>

- название жесткого диска: /dev/sda
- размер диска: 30 GiB, 32212254720 bytes
- количество секторов: 62914560 sectors
- размер swap 2,9 GiB, выводится командой `free -h`

## Part 11. Использование утилиты df

- Пропишем команду `df`.

- ![image.png](./images/part11_1.png)<br>

- размер раздела: 14,339,080
- размер занятого пространства: 6,438,360
- размер свободного пространства: 7,150,540
- процент использования: 48%.
- единица измерения в выводе — блоки по 1 Килобайт (KiB).
- Пропишем команду `df -Th`.

- ![image.png](./images/part11_2.png)<br>

- размер раздела: 14 ГиБ (Gigabytes)
- размер занятого пространства: 6.2 ГиБ (Gigabytes)
- размер свободного пространства: 6.9 ГиБ (Gigabytes)
- процент использования: 48%
- тип файловой системы для корневого раздела — ext4.

## Part 12. Использование утилиты du



- ![image.png](./images/part12_1.png)<br>
Пропишем команду  `du`.

- ![image.png](./images/part12_2.png)<br>
- Получим размер папок /home, /var, /var/log (в человекочитаемом виде)
  - -sh в команде du используется для изменения формата вывода, делая его более удобочитаемым для человека.
  - -s: означает "summarize" (сводный). Когда он используется, du выводит только общий размер указанной директории, а не размеры всех её поддиректорий.
  - -h: означает "human-readable" (человекочитаемый). Он преобразует размеры файлов и директорий в более понятные единицы измерения, такие как килобайты (K), мегабайты (M), гигабайты (G) и т.д., вместо вывода размеров в байтах. Это делает вывод более читабельным и позволяет легче оценить, сколько места занимает каждая директория.

- ![image.png](./images/part12_3.png)<br>
- Получим размер папок /home, /var, /var/log (в байтах)
  - -b указывает du выводить размеры файлов и директорий в байтах.
  - --max-depth=0 ограничивает глубину рекурсии du. Значение 0 означает, что будут показаны только корневые директории

- ![image.png](./images/part12_4.png)<br>
Получим размер всего содержимого в /var/log (не общее, а каждого вложенного элемента, используя *)

## Part 13. Установка и использование утилиты ncdu

- ![image.png](./images/part13_1.png)<br>
Установим утилиту ncdu командой `sudo apt install ncdu`.

- Выход осуществляется через `q`.

- ![image.png](./images/part13_2.png)<br>
Получим размер папки `ncdu /home`.

- ![image.png](./images/part13_3.png)<br>
Получим размер папки `ncdu /var`.

- ![image.png](./images/part13_4.png)<br>
Получим размер папки `ncdu /var/log`.

## Part 14. Работа с системными журналами

- `cat /var/log/dmesg` используется для диагностики проблем с оборудованием и ядром операционной системы

- `cat  /var/log/syslog` собирает сообщения от различных компонентов системы, включая службы, демоны и приложения. Он является одним из основных мест для просмотра информации о работе системы. Содержит записи о системных событиях, таких как запуск и остановка служб, ошибки и предупреждения, а также сообщения от многих приложений.

- `cat /var/log/auth.log` содержит записи, связанные с процессами аутентификации пользователей и аудита безопасности. Это включает в себя попытки входа в систему, успешные и неудачные авторизации, изменения паролей и другие действия, связанные с безопасностью системы. Этот журнал полезен для аудита безопасности и отслеживания действий пользователей.

- ![image.png](./images/part14_1.png)<br>
Пропишем команду `grep login /var/log/auth.log` время последней успешной авторизации AUG 5 14:28:24 , user spaghetc, by LOGIN

- Выполним перезапуск службы SSHd `sudo systemctl restart ssh`

- ![image.png](./images/part14_2.png)<br>
- Найдем сообщение о рестарте службы командой `cat /var/log/syslog`


## Part 15. Использование планировщика заданий CRON

- ![image.png](./images/part15_1.png)<br>
Пропишем команду `sudo crontab -e`.

- ![image.png](./images/part15_2.png)<br>
Выберем из предложенных редакторов nano. В конце файла пропишем строку `*/2 * * * * uptime`.


- Далее по порядку
 - (*/2) - Определяет минуты. */2 означает "каждые 2 минуты".
 - (*) - Определяет часы. Звездочка означает "любой час".
 - (*) - Определяет день месяца. Звездочка означает "любой день месяца".
 - (*) - Определяет месяц. Звездочка означает "любой месяц".
 - (*) - Определяет день недели. Звездочка означает "любой день недели".
 - (*/2 * * * * uptime) означает, что команда uptime будет выполняться каждые 2 минуты каждый час каждого дня месяца, каждого месяца, каждого дня недели


- ![image.png](./images/part15_3.png)<br>
3 строки в системных журналах о выполнении


- ![image.png](./images/part15_4.png)<br>
Командой `sudo crontab -l` получим список текущих заданий для cron.


- ![image.png](./images/part15_5.png)<br>
Командой `sudo crontab -r` удалим задания из планировщика. Еще раз получим спискок текущих задач cron и убедимся, что задания удалены.